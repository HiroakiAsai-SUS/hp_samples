<!-- 360°閲覧できるビューワーのように、WEBサイトに3Dを埋め込む例 -->
<html>
  <head>
    <!-- A-FrameをCDNから読み込む -->
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <!-- aframe-orbit-controlsをCDNから読み込む -->
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-orbit-controls@1.3.0/dist/aframe-orbit-controls.min.js"></script>
    <script src="https://unpkg.com/aframe-supercraft-loader@1.1.3/dist/aframe-supercraft-loader.js"></script>
    
    
  </head>
<body>
  <a-scene embedded arjs vr-mode-ui="enabled: false">
    <a-assets>
      <!-- 3Dモデルを読み込む -->
      <a-asset-item id="dragon" src="./obj/fukui/WalkingBrakio.glb" scale="1 1 1"></a-asset-item>
    </a-assets>
    <!-- マーカーを設定する -->
    <a-marker id="base" type="pattern" url="./pattern-ar-test.patt" emitevents="true"></a-marker>
    <!-- aframe-orbit-controlsのプロパティを記述 -->
    <a-entity camera look-controls orbit-controls="target: 0 1.6 0; maxPolarAngle:180; minDistance: 0.5; maxDistance: 200; initialPosition: 0 0 40"></a-entity>
    
    <!-- 3Dモデルを読み込んで、位置やスケールなど定義する -->
    <a-entity visible="false" gltf-model="#dragon" id="test" position="0 -3 0" rotation="0 5 5" scale="100 100 100" animation-mixer></a-entity>

  </a-scene>
</body>
<script>
  let testEntityAdded = false;
  let markerLostflg = false;

  //glTFの表示が暗くなる問題に対処
  document.querySelector("a-scene").renderer.gammaOutput=true;
  
  window.onload = function() {
      //glTFの表示が暗くなる問題に対処
      document.querySelector("a-scene").renderer.gammaOutput=true;

      const marker = document.querySelector('a-marker');
      
        marker.addEventListener('markerFound', function () {
          if(!testEntityAdded) {
            console.log('markerFound');

            // 3Dモデルを追加する
            const entity = document.querySelector('#test');
            entity.setAttribute('visible', true );
          }
          testEntityAdded = true;
          markerLostflg = false; 
      });

      marker.addEventListener('markerLost', function () {
        console.log('markerLost');
        markerLostflg = true;
      });
    }
</script>
</html>